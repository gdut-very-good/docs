# 歪瑞古德小队编码规范

Author：[歪瑞古德小队](https://www.cnblogs.com/misterchaos/p/12766888.html)-黄钰朝

## 一、代码规范

### 1.1 变量命名

- 代码中的命名均不能以下划线或美元符号开始，也不能以下划线或美元符号结束

- 所有编程相关的命名严禁使用拼音与英文混合的方式，更不允许直接使用中文的方式
- 方法名、参数名、成员变量、局部变量都统一使用lowerCamelCase风格
- 常量命名全部大写，单词间用下划线隔开，力求语义表达完整清楚，不要嫌名字长
- 接口类中的方法和属性不要加任何修饰符号（public 也不要加），保持代码的简洁性，并加上有效的Javadoc注释。

### 1.2 方法命名

- 获取单个对象的方法用get做前缀
- 获取多个对象的方法用list做前缀，复数结尾，如：listObjects
- 获取统计值的方法用count做前缀 
- 插入的方法用insert做前缀
- 删除的方法用delete做前缀
- 修改的方法用update做前缀

### 1.3 包名规范

- 包名一律小写
- 一个包名只能使用一个单词
- 包名只能是单数（如util而不是utils，尽管有多个类）

### 1.4 代码格式

- if else/switch case等程序结构不允许省略大括号
- if/for/while/switch/do等保留字与括号之间都必须加空格

### 1.5 注释规范

- 不允许使用行后注释
- 接口中的方法必须使用Javadoc注释

## 二、异常和日志

### 2.1 异常处理

- 异常不要用来做流程控制，条件控制
- 不允许保留空的catch块，至少需要打印堆栈或者抛出新的异常（空的catch将导致将来排查错误的难度极高）
- 不要在finally块中使用return。（try块中的return语句执行成功后，并不马上返回，而是继续执行finally块中的语句，如果此处存在return语句，则在此直接返回，无情丢弃掉try块中的返回点。）

### 2.2 日志分级

- error：系统已经发生错误，打印错误信息
- warn：系统可能发生错误，打印风险信息
- info：系统正常执行，打印用户状态的改变，执行的操作
- debug：系统正常执行，打印程序的执行流程

### 2.3 日志规范

- 在日志输出时，字符串变量之间的拼接使用占位符的方式。（因为String字符串的拼接会使用StringBuilder的append()方式，有一定的性能损耗。使用占位符仅是替换动作，可以有效提升性能。）
- 避免重复打印日志

## 三、安全规范

- 隶属于用户个人的页面或者功能必须进行权限控制校验
- 用户敏感数据禁止直接展示，必须对展示数据进行脱敏（比如密码）
- 防止SQL注入，禁止字符串拼接SQL访问数据库
- 用户请求传入的任何参数必须做有效性验证
- 在使用平台资源，譬如短信、邮件、电话、下单、支付，必须实现正确的防重放的机制，如数量限制、疲劳度控制、验证码校验，避免被滥刷而导致资损（比如验证码）



## 四、数据库规范

### 4.1 命名规范

- 表名不使用复数名词
- 表名、字段名必须使用小写字母或数字，禁止出现数字开头，禁止两个下划线中间只出现数字
- 表达是与否概念的字段，必须使用is_xxx的方式命名，数据类型是unsigned tinyint（1表示是，0表示否）
- 禁用保留字，如desc、range、match、delayed等，请参考MySQL官方保留字
- varchar是可变长字符串，不预先分配存储空间，长度不要超过5000，如果存储长度大于此值，定义字段类型为text，独立出来一张表，用主键来对应，避免影响其它字段索引效率。

### 4.2 SQL语句

- 不要使用count(列名)或count(常量)来替代count(*)，count(*)是SQL92定义的标准统计行数的语法，跟数据库无关，跟NULL和非NULL无关
- 不得使用外键与级联，一切外键概念必须在应用层解决
- 禁止使用存储过程，存储过程难以调试和扩展，更没有移植性
- 对于数据库中表记录的查询和变更，只要涉及多个表，都需要在列名前加表的别名（或表名）进行限定
- in操作能避免则避免，若实在避免不了，需要仔细评估in后边的集合元素数量，控制在1000个之内
- 在表查询中，一律不要使用 * 作为查询的字段列表，需要哪些字段必须明确写明
- POJO类的布尔属性不能加is，而数据库字段必须加is_，要求在resultMap中进行字段与属性之间的映射

